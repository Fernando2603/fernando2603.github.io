<!DOCTYPE html>
<html lang="en-US">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="icon" href="Images/al-favicon.png">
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta content="utf-8" http-equiv="encoding">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script></head>
<body>
	<div>
		<table class="table table-hover table-bordered text-center">
			<thead>
				<tr>
					<th>ID</th>
					<th>Name</th>
					<th>Type</th>
					<th>Rarity</th>
					<th>Faction</th>
				</tr>
			</thead>
			<tbody class="output">
			</tbody>
		</table>
	</div>
	<div class="modal-container"></div>
<script>
fetch("https://raw.githubusercontent.com/AzurAPI/azurapi-js-setup/master/ships.json")
.then(response => response.json())
.then((ship) => {
console.log(ship) // console.log if promise success
let output = "";
ship.forEach((ship) => {
	var id = ship.id;
	var name = ship.names.en;
	var type = ship.hullType;
	var rarity = ship.rarity;
	var faction = ship.nationality;
	var wikiUrl = ship.wikiUrl;
	output += `
		<tr class="x${id}" data-toggle="modal" data-target=".modal${id}" onclick="modalCall('${id}')">
			<td>${id}</td>
			<td>${name}</td>
			<td>${type}</td>
			<td>${rarity}</td>
			<td>${faction}</td>
		</tr>
	`
})

// script
$(".output").append(output);
// fetch end
})
.catch((error) => {
  console.error('Error:', error);
});

// creating modal script with ship idx looping
function modalCreate (idx) {
	fetch("https://raw.githubusercontent.com/AzurAPI/azurapi-js-setup/master/ships.json")
	.then(response => response.json())
	.then((ship) => {
	for (var i = 0; i < ship.length; i++) {
		if (ship[i].id == idx) {
			var name = ship[i].names.en;
			var icon = ship[i].thumbnail;
			var rarity = ship[i].rarity;
			return `
				<div class="modal fade modal${idx}" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <table class="table table-bordered text-center">
                                <thead>
                                    <tr>
                                        <th colspan="5">${name}</th>
                                    </tr>
                                    <tr>
                                        <th colspan="5"><img src="${icon}"></th>
                                    </tr>
                                    <tr>
                                        <th>Ships</th>
                                        <td colspan="5">${rarity}</td>
                                    </tr>
                                    <tr>
                                        <th>Round Type</th>
                                        <th>Light</th>
                                        <th>Medium</th>
                                        <th>Heavy</th>
                                        <th>Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
			`;
		}
	}})
}
// create modal and disable onclick attributes to prevent multiple call
function modalCall (idx) {
	$(".modal-container").append(modalCreate(idx))
    $(".x"+idx).removeAttr("onclick")
}
</script>
</body>
</html>